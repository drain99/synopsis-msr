\begin{figure}[t!]
\begin{algorithm}[H]
\begin{footnotesize}
\DontPrintSemicolon
\everypar={\nl}
\SetAlgoLined
\SetKwProg{Fn}{Function}{}{end}
\Fn{$\Theta(p_a,e_a,p_b,e_b)$}{
  $R \mapsfrom \emptyset$\\
  $S \mapsfrom \theta(p_a,e_a,p_b,e_b)$\\
  \lIf{$S = \cons{Fail}$}{\Return{$\cons{Fail}$}}
  \ForEach{$\corrtuple{p_1}{a_1}{p_2}{e_2} \keyword{in} S$}{
    \uIf{$e_2 \keyword{is} atomic$}{
      $R \mapsfrom R \cup \{ \corrtuple{p_1}{a_1}{p_2}{e_2} \}$\\
    }
    \Else{
      $e_1 \mapsfrom {\tt rewrite}(a_1)$\\
      $R_1 \mapsfrom \Theta(p_1,e_1,p_2,e_2)$\\
      \lIf{$R_1 = \cons{Fail}$}{\Return{$\cons{Fail}$}}
      $R \mapsfrom R \cup R_1$\\
    }
  }
  \Return{$\cons{Succ}(R)$}
}
\end{footnotesize}
\caption{Algorithm for unifying two expressions under rewriting of ADT atoms}
\end{algorithm}
\caption{\label{algo:unifyandrewrite}Pseudocode of the algorithm responsible for unifying two expressions
yielding correlation tuples relating only atoms in case of a successful unification.}
\end{figure}